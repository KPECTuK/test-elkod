# Тестовое задание ЭЛКОД

## Ответы на предварительные вопросы

Основная платформа .NET 5

Далее, общение с БД (PostgreSQL) идёт с помощью фреймворка EntityFramework Core (6) + расширение Snickler.EFCore
  общий опыт работы с реляционными БД более 3х лет из них postgre около 1.5 лет
  EF некоторый опыт, однако Dapper в большей степени, Sniсkler - нет опыта

Веб-сокеты - SignalR
  некоторый опыт работы в основном с WebSocket

Пуш-уведомления - Lib.Net.Http.WebPush
  работал с поставщиками сервиса, такими как AppsFlyer, и найтивными мобильными реализациями Apple

Очереди сообщений - RabbitMQ
  некоторый опыт использования, хотя непосредственно в проектировании с использованием технологии участия не принимал

Иногда мы используем холодный кэш (Redis) + горячий кэш (LazyCache)
  использовал аналогичные embed решения, например mongo\unqlite\sqlite, использовал dynamo\cosmo

Документация к API - Swagger
  не использовал, но работал с генераторами документации и фрейворками тестирования для C#\python\C++

Немного GraphQL
  с библиотекой не работал, однако реализовывал парсеры по ECMA для JSON\YAML, в том числе:
    реализовал бинарный парсер на основе AMF с расширениями и элементами GQL
    проводил 'глубокий' рефакторинг NewtonJSON.NET и YAML.NET

Авторизация - JWT токены
  писал сервисы и использованием OAuth2 на IS4 для Core 2.0(1)

Расписания для микро-сервисов-демонов - Quartz
  не использовал

Общение с другими сервисами по HTTP - RestSharp
  есть опыт работы с клиентами http, c RestSharp в том числе

Логгирование в ELK-stack с помощью Serilog
  использовал Serilog, но с ELK-stack не работал

Утилитарные библиотеки - AsyncEnumerator, morelinq, Novell.Directory.Ldap.NETStandard, System.DirectoryServices
  использовал различные библиотеки реализации монад в том числе и для ниток, однако в связи со спецификой задач предпочитал свои решения, непосредственно администрирования Windows касался мало, знаю общую теорию AD, есть опыт администрирования Linux и приложений на базе (Debin\Arch) связанных с инфраструктурой тестирования и развертывания, есть некоторый опыт администрирования AWS

## Оригинальный текст задания

[Предоставлен в виде документа]() Копия текста для декомпозиции ниже.

## Декомпозиция и согласование

Вам поручено реализовать новый функционал системы. База данных и код в вашем полном распоряжении.  

У компании заключены договора с Клиентами на консалтинговые услуги. В рамках договора клиенты могут присылать в компанию запросы по разным каналам(email, апи, телефон), как новые, так и уточняющие другой запрос.  

__Свойства модели Клиент:__ название, ключевитость(не ключевой, ключевой, суперключевой).  

__Свойства модели Запрос:__ тип(консультация, заказ документов), дата создания,  клиент, содержание, ответ, канал(email, апи, телефон), приоритет, ссылка на модель запроса по которому прислано уточнение.  

Для оптимизации работы сотрудников в компании вводится система приоритезации запросов.  

  При создании запроса необходимо установить приоритет, определив его вес по набору критериев. Общий приоритет запроса вычисляется исходя из суммы весов каждого критерия, которому соответствует запрос.  
  Количество и вычисление критериев, как и вес могут меняться. Критерии определяются разработчиками, в каждом критерии своя логика определения подходит или нет критерий запросу.  
  Веса критериев могут меняться, в том числе пользователями(сотрудникам) и связаны с типом запроса.  

> Для примера как может выглядеть таблица весов и соответствующих им критериев по типам задач  
  >
  > |Название критерия|Вес для типа консультация|Вес для типа заказ документов
  > |-:|:-|:-|
  > |ключевой клиент|2|3
  > |суперключевой клиент|3|4
  > |первый запрос от клиента|2|2
  > |наличие уточнений от клиента|4|1

Ваша задача определить архитектуру приложения для решения поставленной задачи: 

  1. __Придумайте и схематично нарисуйте схему базы данных, по Вашему мнению, достаточную для выполнения данной задачи__

  2. __Придумайте и схематично изобразите структуру классов и методов(без реализации) для получения запроса по каналам email, апи(запрос из внешней системы), телефон(заполнение формы на сайте)__

  3. __Придумайте и схематично изобразите структуру классов и методов(без реализации) для сервиса определения приоритета запроса по критериям и весам и сервиса создания запроса с учетом многообразия каналов.__

  4. __Напишите SQL запрос, который вернет клиентов, которые хотя бы раз присылали запрос, но не присылали больше одного уточнения к запросу.__
